<!doctype html><html lang=zh-cn manifest=https://blog.xhstormr.tk/offline.appcache><head><meta charset=utf-8><meta name=renderer content="webkit"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Hibernate Query Language &#183; XhstormR</title><link rel=alternate type=application/rss+xml title=XhstormR href><link rel=icon type=image/x-icon href=https://blog.xhstormr.tk/favicon.ico><link rel=stylesheet href=https://blog.xhstormr.tk/css/uno.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/monokai-sublime.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js></script><script src=https://blog.xhstormr.tk/js/main.min.js async defer></script></head><body><div id=scriptHeader><span class="mobile btn-mobile-menu"><i class="fa fa-bars btn-mobile-menu__icon"></i>
<i class="fa fa-times btn-mobile-close__icon hidden"></i></span><header class="panel-cover panel-cover--collapsed"><div class=panel-main><div class="panel-main__inner panel-inverted"><div class=panel-main__content><h1 class="panel-cover__title panel-title"><a href=https://blog.xhstormr.tk/ title="link to homepage for XhstormR">XhstormR</a></h1><hr class=panel-cover__divider><p class=panel-cover__description>On a dark desert highway, cool wind in my hair.</p><hr class="panel-cover__divider panel-cover__divider--secondary"><div class=navigation-wrapper><nav class="cover-navigation cover-navigation--primary"><ul class=navigation><li class=navigation__item><a href=https://blog.xhstormr.tk#blog title="link to XhstormR blog" class=blog-button>Blog</a></li></ul></nav></div></div></div><div class=panel-cover--overlay></div></div></header></div><div class=bodytop><div class=content-wrapper><div class=content-wrapper__inner><div class=post><h1>Hibernate Query Language</h1><span class=post-date>2017-05-19</span><p>Updated on 2017-05-19</p><blockquote><p style=text-align:center><img data-src=/uploads/hibernate-hql.svg alt title data-action=zoom width></p><script>[].forEach.call(document.querySelectorAll("img[data-src]"),function(a){a.setAttribute("src",a.getAttribute("data-src")),a.onload=function(){a.removeAttribute("data-src")}})</script><p>面向对象的查询语言</p><p>select&mldr; + <strong>from&mldr;</strong> + where&mldr; + group by&mldr; + having&mldr; + order by&mldr;</p><p><a href=http://docs.huihoo.com/hibernate/reference-v3_zh-cn/queryhql.html>http://docs.huihoo.com/hibernate/reference-v3_zh-cn/queryhql.html</a></p></blockquote><h2 id=检索对象from>检索对象：from</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>sessionFactory.currentSession.use {
    <span style=color:#66d9ef>it</span>.beginTransaction()

    <span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Customer&#34;</span>, Customer<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
    query.list().forEach { println(<span style=color:#66d9ef>it</span>.name) }

    <span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Commodity c,Seller s&#34;</span>, Array&lt;Any&gt;<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)     <span style=color:#960050;background-color:#1e0010>设置别名</span>
    query.list().forEach { println(Arrays.toString(<span style=color:#66d9ef>it</span>)) }     <span style=color:#960050;background-color:#1e0010>笛卡尓积</span>

    <span style=color:#66d9ef>it</span>.transaction.commit()
}

list()   <span style=color:#960050;background-color:#1e0010>：无视缓存并加载整个数据，发送</span>  <span style=color:#ae81ff>1</span>  <span style=color:#960050;background-color:#1e0010>条</span> SQL <span style=color:#960050;background-color:#1e0010>语句。</span>
iterate()<span style=color:#960050;background-color:#1e0010>：检索缓存并延迟加载数据，发送</span> <span style=color:#ae81ff>1</span>+N <span style=color:#960050;background-color:#1e0010>条</span> SQL <span style=color:#960050;background-color:#1e0010>语句。</span>
</code></pre></div><h2 id=选择属性select>选择属性：select</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#960050;background-color:#1e0010>单个属性：</span>

<span style=color:#960050;background-color:#1e0010>原生对象</span>
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;select birthday from Customer&#34;</span>, Date<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>) }

<span style=color:#960050;background-color:#1e0010>数据去重</span>
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;select distinct sex from Customer&#34;</span>, String<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>) }

<span style=color:#960050;background-color:#1e0010>多个属性：</span>

<span style=color:#960050;background-color:#1e0010>默认为</span> Array
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;select name,address,tel from Seller&#34;</span>, Array&lt;Any&gt;<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(Arrays.toString(<span style=color:#66d9ef>it</span>)) }

<span style=color:#960050;background-color:#1e0010>指定为</span> List
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;select new list(name,address,tel) from Seller&#34;</span>, List<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>) }

<span style=color:#960050;background-color:#1e0010>指定为</span> Map
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;select new map(name,address,tel) from Seller&#34;</span>, Map<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${it[&#34;0&#34;]}</span><span style=color:#e6db74>  </span><span style=color:#e6db74>${it[&#34;1&#34;]}</span><span style=color:#e6db74>  </span><span style=color:#e6db74>${it[&#34;2&#34;]}</span><span style=color:#e6db74>&#34;</span>) }
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;select new map(name as n,address as a,tel as t) from Seller&#34;</span>, Map<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)     <span style=color:#960050;background-color:#1e0010>设置别名</span>
query.list().forEach { println(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${it[&#34;n&#34;]}</span><span style=color:#e6db74>  </span><span style=color:#e6db74>${it[&#34;a&#34;]}</span><span style=color:#e6db74>  </span><span style=color:#e6db74>${it[&#34;t&#34;]}</span><span style=color:#e6db74>&#34;</span>) }

<span style=color:#960050;background-color:#1e0010>指定为自定义对象</span> Test
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;select new Test(name,address,tel) from Seller&#34;</span>, Test<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>) }
</code></pre></div><h3 id=test>Test</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Test</span>(<span style=color:#66d9ef>var</span> s1: String, <span style=color:#66d9ef>var</span> s2: String, <span style=color:#66d9ef>var</span> s3: String)
</code></pre></div><h2 id=限制范围where>限制范围：where</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#960050;background-color:#1e0010>比较运算：</span>

=, <span style=color:#f92672>!=</span>, &lt;, &gt;, <span style=color:#f92672>&lt;=</span>, <span style=color:#f92672>&gt;=</span>
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Commodity c where c.price&gt;400&#34;</span>, Commodity<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>.name) }

<span style=color:#960050;background-color:#1e0010>四则运算：</span>

+, -, *, /
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Commodity c where c.price*5&lt;2000&#34;</span>, Commodity<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>.price) }

<span style=color:#960050;background-color:#1e0010>范围运算：</span>
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>[not]</span> between v1 and v2
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Customer c where c.age between 20 and 35&#34;</span>, Customer<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>.age) }

<span style=color:#960050;background-color:#1e0010>逻辑运算：</span>

and, or, not
<span style=color:#960050;background-color:#1e0010>且，</span> <span style=color:#960050;background-color:#1e0010>或，</span> <span style=color:#960050;background-color:#1e0010>非</span>
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Commodity c where (c.price between 100 and 5000) and (c.category not like &#39;%童装%&#39;)&#34;</span>, Commodity<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>.name) }

<span style=color:#960050;background-color:#1e0010>集合运算：</span>

<span style=color:#960050;background-color:#1e0010>元素是否属于集合（参数为集合，</span>value <span style=color:#66d9ef>in</span> ?<span style=color:#960050;background-color:#1e0010>）：</span>
<span style=color:#a6e22e>[not]</span> <span style=color:#66d9ef>in</span> (v1, v2, v3)
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Customer c where c.age in (20,35)&#34;</span>, Customer<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)     <span style=color:#960050;background-color:#1e0010>底层使用</span> Statement <span style=color:#960050;background-color:#1e0010>接口</span>
query.list().forEach { println(<span style=color:#66d9ef>it</span>.age) }
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Customer c where c.age in :values&#34;</span>, Customer<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)     <span style=color:#960050;background-color:#1e0010>底层使用</span> PreparedStatement <span style=color:#960050;background-color:#1e0010>接口</span>
query.setParameter(<span style=color:#e6db74>&#34;values&#34;</span>, arrayListOf(<span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>35</span>))     <span style=color:#960050;background-color:#1e0010>设置参数</span>
query.list().forEach { println(<span style=color:#66d9ef>it</span>.age) }

<span style=color:#960050;background-color:#1e0010>元素是否属于集合（参数为元素，</span>? <span style=color:#66d9ef>in</span> list<span style=color:#960050;background-color:#1e0010>）：</span>
<span style=color:#a6e22e>[not]</span> member of <span style=color:#f92672>-&gt;</span> [not] <span style=color:#66d9ef>in</span>
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> orderForm = <span style=color:#66d9ef>it</span>.<span style=color:#66d9ef>get</span>(OrderForm<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java, <span style=color:#ae81ff>1</span>)
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Customer c where :values member of c.orderforms&#34;</span>, Customer<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.setParameter(<span style=color:#e6db74>&#34;values&#34;</span>, orderForm)     <span style=color:#960050;background-color:#1e0010>设置参数</span>
query.list().forEach { println(<span style=color:#66d9ef>it</span>.name) }

<span style=color:#960050;background-color:#1e0010>集合是否为空集：</span>
<span style=color:#66d9ef>is</span> empty <span style=color:#f92672>-&gt;</span> not exists
<span style=color:#66d9ef>is</span> not empty <span style=color:#f92672>-&gt;</span> exists
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;select o.orderitems.size from OrderForm o where o.orderitems is not empty&#34;</span>, Integer<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>) }

<span style=color:#960050;background-color:#1e0010>空值判断：</span>

<span style=color:#66d9ef>is</span> [not] <span style=color:#66d9ef>null</span>
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Commodity c where c.description is null&#34;</span>, Commodity<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>.name) }

<span style=color:#960050;background-color:#1e0010>字符串匹配：</span>

<span style=color:#960050;background-color:#1e0010>精确匹配：</span>like <span style=color:#960050;background-color:#1e0010>&#39;张爱玲&#39;</span>
<span style=color:#960050;background-color:#1e0010>模糊匹配：</span>like <span style=color:#960050;background-color:#1e0010>&#39;张</span>%<span style=color:#960050;background-color:#1e0010>&#39;</span>
<span style=color:#960050;background-color:#1e0010>通配符：</span>
%<span style=color:#960050;background-color:#1e0010>：任意字符</span>
_<span style=color:#960050;background-color:#1e0010>：任意一个字符</span>
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Customer c where c.address like &#39;%北京%&#39;&#34;</span>, Customer<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
query.list().forEach { println(<span style=color:#66d9ef>it</span>.address) }

uniqueResult<span style=color:#960050;background-color:#1e0010>：查询结果最多只能有一个，否则抛出异常。</span>
<span style=color:#f92672>----</span>
<span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Customer c where c.age&gt;30&#34;</span>, Customer<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
<span style=color:#66d9ef>val</span> customer = query.uniqueResultOptional().orElse(Customer(name = <span style=color:#e6db74>&#34;不存在&#34;</span>))
println(customer.name)
</code></pre></div><h2 id=排序结果order-by>排序结果：order by</h2><ul><li>升序排序（由低到高）：asc</li><li>降序排序（由高到低）：desc</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>val</span> query = <span style=color:#66d9ef>it</span>.createQuery(<span style=color:#e6db74>&#34;from Commodity c order by c.seller.id asc,c.price desc,c.name asc&#34;</span>, Commodity<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)     <span style=color:#960050;background-color:#1e0010>多排序规则</span>
query.list().forEach { println(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${it.seller?.id}</span><span style=color:#e6db74>  </span><span style=color:#e6db74>${it.price}</span><span style=color:#e6db74>  </span><span style=color:#e6db74>${it.name}</span><span style=color:#e6db74>&#34;</span>) }

<span style=color:#f92672>----</span>
<span style=color:#960050;background-color:#1e0010>输出：</span>
<span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>200</span>  <span style=color:#960050;background-color:#1e0010>女士套装</span>
<span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>200</span>  <span style=color:#960050;background-color:#1e0010>男士西服</span>
<span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>120</span>  <span style=color:#960050;background-color:#1e0010>中式童装</span>
<span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>4000</span>  <span style=color:#960050;background-color:#1e0010>笔记本电脑</span>
<span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>400</span>  <span style=color:#960050;background-color:#1e0010>移动硬盘</span>
<span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>5000</span>  <span style=color:#960050;background-color:#1e0010>液晶电视</span>
<span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>4000</span>  <span style=color:#960050;background-color:#1e0010>滚筒洗衣机</span>
<span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>50</span>  <span style=color:#960050;background-color:#1e0010>《</span>Java<span style=color:#960050;background-color:#1e0010>核心》</span>
<span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>40</span>  <span style=color:#960050;background-color:#1e0010>《海底两万里》</span>
<span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>30</span>  <span style=color:#960050;background-color:#1e0010>《</span>hibernate<span style=color:#960050;background-color:#1e0010>编程》</span>
</code></pre></div><h2 id=code>Code</h2><h3 id=seller商家>Seller（商家）</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>import</span> javax.persistence.*

<span style=color:#a6e22e>@Entity</span>
<span style=color:#a6e22e>@NamedQuery</span>(name = <span style=color:#e6db74>&#34;allSeller&#34;</span>, query = <span style=color:#e6db74>&#34;from Seller&#34;</span>)
<span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Seller</span>(
        <span style=color:#a6e22e>@Id</span>
        <span style=color:#a6e22e>@GeneratedValue</span>(strategy = GenerationType.IDENTITY)
        <span style=color:#66d9ef>val</span> id: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> name: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> tel: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> address: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> website: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> star: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> business: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#a6e22e>@OneToMany</span>(mappedBy = <span style=color:#e6db74>&#34;seller&#34;</span>, cascade = arrayOf(CascadeType.ALL), orphanRemoval = <span style=color:#66d9ef>true</span>)
        <span style=color:#66d9ef>val</span> commoditys: MutableList&lt;Commodity&gt; = arrayListOf()
) {
    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>addCommodity</span>(commodity: Commodity) {
        commoditys.add(commodity)
        commodity.seller = <span style=color:#66d9ef>this</span>
    }

    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>removeCommodity</span>(commodity: Commodity) {
        commoditys.remove(commodity)
        commodity.seller = <span style=color:#66d9ef>null</span>
    }
}
</code></pre></div><h3 id=commodity商品>Commodity（商品）</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>import</span> javax.persistence.*

<span style=color:#a6e22e>@Entity</span>
<span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Commodity</span>(
        <span style=color:#a6e22e>@Id</span>
        <span style=color:#a6e22e>@GeneratedValue</span>(strategy = GenerationType.IDENTITY)
        <span style=color:#66d9ef>val</span> id: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> name: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> price: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> unit: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> category: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> description: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#a6e22e>@ManyToOne</span>
        <span style=color:#66d9ef>var</span> seller: Seller? = <span style=color:#66d9ef>null</span>,
        <span style=color:#a6e22e>@OneToMany</span>(mappedBy = <span style=color:#e6db74>&#34;commodity&#34;</span>, cascade = arrayOf(CascadeType.ALL), orphanRemoval = <span style=color:#66d9ef>true</span>)
        <span style=color:#66d9ef>val</span> orderitems: MutableList&lt;OrderItem&gt; = arrayListOf()
) {
    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>addOrderItem</span>(orderItem: OrderItem) {
        orderitems.add(orderItem)
        orderItem.commodity = <span style=color:#66d9ef>this</span>
    }

    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>removeOrderItem</span>(orderItem: OrderItem) {
        orderitems.remove(orderItem)
        orderItem.commodity = <span style=color:#66d9ef>null</span>
    }
}
</code></pre></div><h3 id=customer客户>Customer（客户）</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>import</span> java.util.*
<span style=color:#66d9ef>import</span> javax.persistence.*

<span style=color:#a6e22e>@Entity</span>
<span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Customer</span>(
        <span style=color:#a6e22e>@Id</span>
        <span style=color:#a6e22e>@GeneratedValue</span>(strategy = GenerationType.IDENTITY)
        <span style=color:#66d9ef>val</span> id: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> name: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> tel: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> address: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> email: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> sex: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> description: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> age: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> birthday: Date? = <span style=color:#66d9ef>null</span>,
        <span style=color:#a6e22e>@OneToMany</span>(mappedBy = <span style=color:#e6db74>&#34;customer&#34;</span>, cascade = arrayOf(CascadeType.ALL), orphanRemoval = <span style=color:#66d9ef>true</span>)
        <span style=color:#66d9ef>val</span> orderforms: MutableList&lt;OrderForm&gt; = arrayListOf()
) {
    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>addOrderForm</span>(orderForm: OrderForm) {
        orderforms.add(orderForm)
        orderForm.customer = <span style=color:#66d9ef>this</span>
    }

    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>removeOrderForm</span>(orderForm: OrderForm) {
        orderforms.remove(orderForm)
        orderForm.customer = <span style=color:#66d9ef>null</span>
    }
}
</code></pre></div><h3 id=orderform订单>OrderForm（订单）</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>import</span> java.util.*
<span style=color:#66d9ef>import</span> javax.persistence.*

<span style=color:#a6e22e>@Entity</span>
<span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>OrderForm</span>(
        <span style=color:#a6e22e>@Id</span>
        <span style=color:#a6e22e>@GeneratedValue</span>(strategy = GenerationType.IDENTITY)
        <span style=color:#66d9ef>val</span> id: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> tradedate: Date? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> status: String? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> amount: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#a6e22e>@ManyToOne</span>
        <span style=color:#66d9ef>var</span> customer: Customer? = <span style=color:#66d9ef>null</span>,
        <span style=color:#a6e22e>@OneToMany</span>(mappedBy = <span style=color:#e6db74>&#34;orderForm&#34;</span>, cascade = arrayOf(CascadeType.ALL), orphanRemoval = <span style=color:#66d9ef>true</span>)
        <span style=color:#66d9ef>val</span> orderitems: MutableList&lt;OrderItem&gt; = arrayListOf()
) {
    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>addOrderItem</span>(orderItem: OrderItem) {
        orderitems.add(orderItem)
        orderItem.orderForm = <span style=color:#66d9ef>this</span>
    }

    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>removeOrderItem</span>(orderItem: OrderItem) {
        orderitems.remove(orderItem)
        orderItem.orderForm = <span style=color:#66d9ef>null</span>
    }
}
</code></pre></div><h3 id=orderitem订单明细>OrderItem（订单明细）</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>import</span> javax.persistence.*

<span style=color:#a6e22e>@Entity</span>
<span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>OrderItem</span>(
        <span style=color:#a6e22e>@Id</span>
        <span style=color:#a6e22e>@GeneratedValue</span>(strategy = GenerationType.IDENTITY)
        <span style=color:#66d9ef>val</span> id: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> amount: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> actprice: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#66d9ef>var</span> discount: Int? = <span style=color:#66d9ef>null</span>,
        <span style=color:#a6e22e>@ManyToOne</span>
        <span style=color:#66d9ef>var</span> orderForm: OrderForm? = <span style=color:#66d9ef>null</span>,
        <span style=color:#a6e22e>@ManyToOne</span>
        <span style=color:#66d9ef>var</span> commodity: Commodity? = <span style=color:#66d9ef>null</span>
)
</code></pre></div><h3 id=a>A</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>import</span> org.hibernate.SessionFactory
<span style=color:#66d9ef>import</span> org.hibernate.boot.MetadataSources
<span style=color:#66d9ef>import</span> org.hibernate.boot.registry.StandardServiceRegistryBuilder
<span style=color:#66d9ef>import</span> java.util.*

<span style=color:#66d9ef>val</span> sessionFactory: SessionFactory <span style=color:#66d9ef>by</span> lazy {
    <span style=color:#66d9ef>val</span> registry = StandardServiceRegistryBuilder().configure().build()
    MetadataSources(registry).buildMetadata().buildSessionFactory()
}

<span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>main</span>(args: Array&lt;String&gt;) {
    <span style=color:#66d9ef>val</span> seller1 = Seller(name = <span style=color:#e6db74>&#34;A服装店&#34;</span>, tel = <span style=color:#e6db74>&#34;13000000000&#34;</span>, address = <span style=color:#e6db74>&#34;中国重庆市××区&#34;</span>, website = <span style=color:#e6db74>&#34;www.a.com&#34;</span>, star = <span style=color:#ae81ff>5</span>, business = <span style=color:#e6db74>&#34;经营各种服装&#34;</span>)
    <span style=color:#66d9ef>val</span> seller2 = Seller(name = <span style=color:#e6db74>&#34;B数码店&#34;</span>, tel = <span style=color:#e6db74>&#34;15800000000&#34;</span>, address = <span style=color:#e6db74>&#34;中国杭州市××区&#34;</span>, website = <span style=color:#e6db74>&#34;www.b.com&#34;</span>, star = <span style=color:#ae81ff>4</span>, business = <span style=color:#e6db74>&#34;经营各种数码产品&#34;</span>)
    <span style=color:#66d9ef>val</span> seller3 = Seller(name = <span style=color:#e6db74>&#34;C电器店&#34;</span>, tel = <span style=color:#e6db74>&#34;16800000000&#34;</span>, address = <span style=color:#e6db74>&#34;中国深圳市××区&#34;</span>, website = <span style=color:#e6db74>&#34;www.c.com&#34;</span>, star = <span style=color:#ae81ff>4</span>, business = <span style=color:#e6db74>&#34;经营各种家电&#34;</span>)
    <span style=color:#66d9ef>val</span> seller4 = Seller(name = <span style=color:#e6db74>&#34;D书籍店&#34;</span>, tel = <span style=color:#e6db74>&#34;17600000000&#34;</span>, address = <span style=color:#e6db74>&#34;中国西安市××区&#34;</span>, website = <span style=color:#e6db74>&#34;www.d.com&#34;</span>, star = <span style=color:#ae81ff>5</span>, business = <span style=color:#e6db74>&#34;经营各种书籍&#34;</span>)

    <span style=color:#66d9ef>val</span> customer1 = Customer(name = <span style=color:#e6db74>&#34;张三&#34;</span>, tel = <span style=color:#e6db74>&#34;13800000000&#34;</span>, address = <span style=color:#e6db74>&#34;中国上海××区××路&#34;</span>, email = <span style=color:#e6db74>&#34;13800000000@138.com&#34;</span>, sex = <span style=color:#e6db74>&#34;男&#34;</span>, age = <span style=color:#ae81ff>25</span>, birthday = Date(), description = <span style=color:#e6db74>&#34;热爱编程的程序员&#34;</span>)
    <span style=color:#66d9ef>val</span> customer2 = Customer(name = <span style=color:#e6db74>&#34;李四&#34;</span>, tel = <span style=color:#e6db74>&#34;13888888888&#34;</span>, address = <span style=color:#e6db74>&#34;中国北京××区××路&#34;</span>, email = <span style=color:#e6db74>&#34;13888888888@138.com&#34;</span>, sex = <span style=color:#e6db74>&#34;女&#34;</span>, age = <span style=color:#ae81ff>20</span>, birthday = Date(), description = <span style=color:#e6db74>&#34;酷爱网购的白领&#34;</span>)
    <span style=color:#66d9ef>val</span> customer3 = Customer(name = <span style=color:#e6db74>&#34;王五&#34;</span>, tel = <span style=color:#e6db74>&#34;15888888888&#34;</span>, address = <span style=color:#e6db74>&#34;中国深圳××区××路&#34;</span>, email = <span style=color:#e6db74>&#34;15888888888@158.com&#34;</span>, sex = <span style=color:#e6db74>&#34;男&#34;</span>, age = <span style=color:#ae81ff>35</span>, birthday = Date(), description = <span style=color:#e6db74>&#34;这个家伙很懒，什么也没有留下&#34;</span>)

    <span style=color:#66d9ef>val</span> commodity1 = Commodity(name = <span style=color:#e6db74>&#34;中式童装&#34;</span>, price = <span style=color:#ae81ff>120</span>, unit = <span style=color:#e6db74>&#34;套&#34;</span>, category = <span style=color:#e6db74>&#34;童装&#34;</span>, description = <span style=color:#e6db74>&#34;中式童装&#34;</span>)
    <span style=color:#66d9ef>val</span> commodity2 = Commodity(name = <span style=color:#e6db74>&#34;女士套装&#34;</span>, price = <span style=color:#ae81ff>200</span>, unit = <span style=color:#e6db74>&#34;套&#34;</span>, category = <span style=color:#e6db74>&#34;女装&#34;</span>, description = <span style=color:#e6db74>&#34;女士职业套装&#34;</span>)
    <span style=color:#66d9ef>val</span> commodity3 = Commodity(name = <span style=color:#e6db74>&#34;男士西服&#34;</span>, price = <span style=color:#ae81ff>200</span>, unit = <span style=color:#e6db74>&#34;套&#34;</span>, category = <span style=color:#e6db74>&#34;男装&#34;</span>, description = <span style=color:#e6db74>&#34;男士西服套装&#34;</span>)
    <span style=color:#66d9ef>val</span> commodity4 = Commodity(name = <span style=color:#e6db74>&#34;笔记本电脑&#34;</span>, price = <span style=color:#ae81ff>4000</span>, unit = <span style=color:#e6db74>&#34;台&#34;</span>, category = <span style=color:#e6db74>&#34;电脑&#34;</span>, description = <span style=color:#e6db74>&#34;双核笔记本电脑&#34;</span>)
    <span style=color:#66d9ef>val</span> commodity5 = Commodity(name = <span style=color:#e6db74>&#34;移动硬盘&#34;</span>, price = <span style=color:#ae81ff>400</span>, unit = <span style=color:#e6db74>&#34;块&#34;</span>, category = <span style=color:#e6db74>&#34;电脑周边&#34;</span>, description = <span style=color:#e6db74>&#34;1T移动硬盘&#34;</span>)
    <span style=color:#66d9ef>val</span> commodity6 = Commodity(name = <span style=color:#e6db74>&#34;液晶电视&#34;</span>, price = <span style=color:#ae81ff>5000</span>, unit = <span style=color:#e6db74>&#34;台&#34;</span>, category = <span style=color:#e6db74>&#34;电视&#34;</span>, description = <span style=color:#e6db74>&#34;4k液晶电视&#34;</span>)
    <span style=color:#66d9ef>val</span> commodity7 = Commodity(name = <span style=color:#e6db74>&#34;滚筒洗衣机&#34;</span>, price = <span style=color:#ae81ff>4000</span>, unit = <span style=color:#e6db74>&#34;台&#34;</span>, category = <span style=color:#e6db74>&#34;洗衣机&#34;</span>, description = <span style=color:#e6db74>&#34;滚筒洗衣机&#34;</span>)
    <span style=color:#66d9ef>val</span> commodity8 = Commodity(name = <span style=color:#e6db74>&#34;《hibernate编程》&#34;</span>, price = <span style=color:#ae81ff>30</span>, unit = <span style=color:#e6db74>&#34;&#34;</span>, category = <span style=color:#e6db74>&#34;实体书&#34;</span>, description = <span style=color:#e6db74>&#34;介绍hibernate编程&#34;</span>)
    <span style=color:#66d9ef>val</span> commodity9 = Commodity(name = <span style=color:#e6db74>&#34;《Java核心》&#34;</span>, price = <span style=color:#ae81ff>50</span>, unit = <span style=color:#e6db74>&#34;&#34;</span>, category = <span style=color:#e6db74>&#34;实体书&#34;</span>, description = <span style=color:#e6db74>&#34;介绍Java编程核心&#34;</span>)
    <span style=color:#66d9ef>val</span> commodity10 = Commodity(name = <span style=color:#e6db74>&#34;《海底两万里》&#34;</span>, price = <span style=color:#ae81ff>40</span>, unit = <span style=color:#e6db74>&#34;&#34;</span>, category = <span style=color:#e6db74>&#34;电子书&#34;</span>, description = <span style=color:#e6db74>&#34;经典科幻小说&#34;</span>)

    <span style=color:#66d9ef>val</span> orderForm1 = OrderForm(status = <span style=color:#e6db74>&#34;已收货&#34;</span>, amount = <span style=color:#ae81ff>4400</span>, tradedate = Date())
    <span style=color:#66d9ef>val</span> orderForm2 = OrderForm(status = <span style=color:#e6db74>&#34;已发货&#34;</span>, amount = <span style=color:#ae81ff>520</span>, tradedate = Date())
    <span style=color:#66d9ef>val</span> orderForm3 = OrderForm(status = <span style=color:#e6db74>&#34;已付款&#34;</span>, amount = <span style=color:#ae81ff>9120</span>, tradedate = Date())

    <span style=color:#66d9ef>val</span> orderItem1 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>4000</span>)
    <span style=color:#66d9ef>val</span> orderItem2 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>400</span>)
    <span style=color:#66d9ef>val</span> orderItem3 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>120</span>)
    <span style=color:#66d9ef>val</span> orderItem4 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>200</span>)
    <span style=color:#66d9ef>val</span> orderItem5 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>200</span>)
    <span style=color:#66d9ef>val</span> orderItem6 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>5000</span>)
    <span style=color:#66d9ef>val</span> orderItem7 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>4000</span>)
    <span style=color:#66d9ef>val</span> orderItem8 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>30</span>)
    <span style=color:#66d9ef>val</span> orderItem9 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>50</span>)
    <span style=color:#66d9ef>val</span> orderItem10 = OrderItem(discount = <span style=color:#ae81ff>1</span>, amount = <span style=color:#ae81ff>1</span>, actprice = <span style=color:#ae81ff>40</span>)

    seller1.let {
        <span style=color:#66d9ef>it</span>.addCommodity(commodity1)
        <span style=color:#66d9ef>it</span>.addCommodity(commodity2)
        <span style=color:#66d9ef>it</span>.addCommodity(commodity3)
    }
    seller2.let {
        <span style=color:#66d9ef>it</span>.addCommodity(commodity4)
        <span style=color:#66d9ef>it</span>.addCommodity(commodity5)
    }
    seller3.let {
        <span style=color:#66d9ef>it</span>.addCommodity(commodity6)
        <span style=color:#66d9ef>it</span>.addCommodity(commodity7)
    }
    seller4.let {
        <span style=color:#66d9ef>it</span>.addCommodity(commodity8)
        <span style=color:#66d9ef>it</span>.addCommodity(commodity9)
        <span style=color:#66d9ef>it</span>.addCommodity(commodity10)
    }

    customer1.addOrderForm(orderForm1)
    customer2.addOrderForm(orderForm2)
    customer3.addOrderForm(orderForm3)

    orderForm1.let {
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem1)
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem2)
    }
    orderForm2.let {
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem3)
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem4)
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem5)
    }
    orderForm3.let {
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem6)
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem7)
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem8)
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem9)
        <span style=color:#66d9ef>it</span>.addOrderItem(orderItem10)
    }

    commodity1.addOrderItem(orderItem3)
    commodity2.addOrderItem(orderItem4)
    commodity3.addOrderItem(orderItem5)
    commodity4.addOrderItem(orderItem1)
    commodity5.addOrderItem(orderItem2)
    commodity6.addOrderItem(orderItem6)
    commodity7.addOrderItem(orderItem7)
    commodity8.addOrderItem(orderItem8)
    commodity9.addOrderItem(orderItem9)
    commodity10.addOrderItem(orderItem10)

    sessionFactory.currentSession.use {
        <span style=color:#66d9ef>it</span>.beginTransaction()
        <span style=color:#66d9ef>it</span>.save(seller1)
        <span style=color:#66d9ef>it</span>.save(seller2)
        <span style=color:#66d9ef>it</span>.save(seller3)
        <span style=color:#66d9ef>it</span>.save(seller4)
        <span style=color:#66d9ef>it</span>.save(customer1)
        <span style=color:#66d9ef>it</span>.save(customer2)
        <span style=color:#66d9ef>it</span>.save(customer3)
        <span style=color:#66d9ef>it</span>.transaction.commit()
    }

    sessionFactory.close()
}
</code></pre></div></div><div class=sharing style=text-align:center><br><p>捐赠支持</p><p>如果我的文章对你有所帮助，欢迎通过支付宝的扫一扫，轻松的向我发起捐助。</p><p>对于你的支持，我会心怀感激且倍感荣幸地接受，并继续努力。</p><img src=https://ww4.sinaimg.cn/large/a15b4afegw1fbn096ql6dj20dw0dwwe9.jpg alt title data-action=zoom width=40%><p></p><br>&copy; 2015-2020 XhstormR</div></div></div></div><div id=backtop><a href=# title>TOP</a></div><nav id=TableOfContents><ul><li><a href=#检索对象from>检索对象：from</a></li><li><a href=#选择属性select>选择属性：select</a><ul><li><a href=#test>Test</a></li></ul></li><li><a href=#限制范围where>限制范围：where</a></li><li><a href=#排序结果order-by>排序结果：order by</a></li><li><a href=#code>Code</a><ul><li><a href=#seller商家>Seller（商家）</a></li><li><a href=#commodity商品>Commodity（商品）</a></li><li><a href=#customer客户>Customer（客户）</a></li><li><a href=#orderform订单>OrderForm（订单）</a></li><li><a href=#orderitem订单明细>OrderItem（订单明细）</a></li><li><a href=#a>A</a></li></ul></li></ul></nav><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/yaml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/kotlin.min.js></script><script>hljs.initHighlightingOnLoad()</script><script src=https://blog.xhstormr.tk/js/zoom.min.js></script><script>window.addEventListener("load",show),window.onscroll=show;function show(){document.documentElement.scrollTop+document.body.scrollTop>300?document.getElementById("backtop").style.display="block":document.getElementById("backtop").style.display="none"}</script><script type=text/javascript color=0,0,0 opacity=1 zindex=-2 count=49 src=https://cdnjs.cloudflare.com/ajax/libs/canvas-nest.js/2.0.4/canvas-nest.js></script></body></html>