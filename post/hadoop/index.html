<!doctype html><html lang=zh-cn manifest=https://blog.xhstormr.tk/offline.appcache><head><meta charset=utf-8><meta name=renderer content="webkit"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>自学 Hadoop &#183; XhstormR</title><link rel=alternate type=application/rss+xml title=XhstormR href><link rel=icon type=image/x-icon href=https://blog.xhstormr.tk/favicon.ico><link rel=stylesheet href=https://blog.xhstormr.tk/css/uno.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/monokai-sublime.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js></script><script src=https://blog.xhstormr.tk/js/main.min.js async defer></script></head><body><div id=scriptHeader><span class="mobile btn-mobile-menu"><i class="fa fa-bars btn-mobile-menu__icon"></i>
<i class="fa fa-times btn-mobile-close__icon hidden"></i></span><header class="panel-cover panel-cover--collapsed"><div class=panel-main><div class="panel-main__inner panel-inverted"><div class=panel-main__content><h1 class="panel-cover__title panel-title"><a href=https://blog.xhstormr.tk/ title="link to homepage for XhstormR">XhstormR</a></h1><hr class=panel-cover__divider><p class=panel-cover__description>On a dark desert highway, cool wind in my hair.</p><hr class="panel-cover__divider panel-cover__divider--secondary"><div class=navigation-wrapper><nav class="cover-navigation cover-navigation--primary"><ul class=navigation><li class=navigation__item><a href=https://blog.xhstormr.tk#blog title="link to XhstormR blog" class=blog-button>Blog</a></li></ul></nav></div></div></div><div class=panel-cover--overlay></div></div></header></div><div class=bodytop><div class=content-wrapper><div class=content-wrapper__inner><div class=post><h1>自学 Hadoop</h1><span class=post-date>2016-04-14</span><p>Updated on 2016-05-22</p><blockquote><p><a href=https://hadoop.apache.org/>https://hadoop.apache.org/</a></p><p><a href=https://hadoop.apache.org/docs/r1.0.4/cn/>https://hadoop.apache.org/docs/r1.0.4/cn/</a></p><p><img src=/uploads/hadoop-core.png alt></p><p>分布式存储(HDFS)，分布式计算(MapReduce)</p></blockquote><h2 id=hadoop>Hadoop</h2><p>Hadoop 主要包括 4 个模块</p><ul><li><p>Common：通用的基础程序以支持其他Hadoop的模块。</p></li><li><p>HDFS：分布式文件系统，它提供对应用程序数据的高吞吐量访问。 (Hadoop Distributed File System)</p></li><li><p>YARN：一种作业调度和集群资源管理平台，在上面运行分布式计算，典型的计算框架有 MapReduce（批处理） , Storm（流式处理） , Spark（内存计算）。</p></li><li><p>MapReduce：基于 YARN 系统的大型数据并行计算框架。</p></li></ul><p>Hadoop 的其它一些子项目</p><ul><li><p>Hive™：支持数据汇总和即席查询的数据仓库。</p></li><li><p>HBase™：一种可扩展的支持大量结构化数据存储的分布式数据库。</p></li><li><p>Mahout™：一种可扩展的机器学习和数据挖掘库。</p></li><li><p>Pig™：一个高层次的数据流语言和并行计算框架。</p></li></ul><h2 id=hdfs-架构>HDFS 架构</h2><ul><li>主从结构（Master , Slaver）<ul><li>主节点，可以有多个 namenode （Activity - Standby）<ul><li>接收用户操作请求，是用户操作的入口</li><li>维护文件系统的目录结构，称作命名空间</li><li>管理文件与 block 之间关系，block 与 datanode 之间关系</li></ul></li><li>从节点，有很多个 datanode<ul><li>存储文件</li><li>文件被分成 block 存储在磁盘上</li><li>为保证数据安全，文件会有多个副本</li></ul></li></ul></li></ul><p><img src=/uploads/hadoop-hdfs.png alt></p><h2 id=mapreduce-架构>MapReduce 架构</h2><ul><li>主从结构<ul><li>主节点，只有一个 JobTracker<ul><li>接收客户提交的计算任务</li><li>把计算任务分给 TaskTracker 执行，即任务调度</li><li>监控 TaskTracker 的执行情况</li></ul></li><li>从节点，有很多个 TaskTracker<ul><li>执行 JobTracker 分配的计算任务（Map 映射，Reduce 归约）</li></ul></li></ul></li></ul><p><img src=/uploads/hadoop-mapreduce.png alt></p><h2 id=yarn-架构>Yarn 架构</h2><ul><li>主从结构<ul><li>主节点，只有一个 ResourceManager<ul><li>集群资源的分配与调度</li><li>MapReduce、Storm、Spark 等应用必须实现 ApplicationMaster 接口才能被 RM 管理</li></ul></li><li>从节点，有很多个 NodeManager<ul><li>单节点资源的管理</li></ul></li></ul></li></ul><h2 id=hadoop-1>Hadoop</h2><pre><code>[root@master sbin]$ ./start-all.sh #启动 Hadoop 集群
[root@master sbin]$ ./stop-all.sh #停止 Hadoop 集群
    start-dfs.sh start-mapreduce.sh
    stop-dfs.sh stop-mapreduce.sh
[root@master sbin]$ ./hadoop-daemons.sh #单独启动停止 Hadoop 进程
    HDFS 模块启动顺序
    * NameNode
    * DataNode
    * SecondaryNameNode
    MapReduce 模块启动顺序
    * JobTracker
    * TaskTracker
    关闭顺序相反

[root@master ~]$ jps #查看 Hadoop 进程
4711 Jps
3867 NodeManager
3435 NameNode
3772 ResourceManager
3528 DataNode

启动 Hadoop 时，如果出现错误信息 `: Name or service not knownstname master`
需要将 hadoop-2.7.0/etc/hadoop/slaves 中的主机名换成 IP 地址，本人推荐一开始就写成 IP 地址
</code></pre><h2 id=hdfs>HDFS</h2><pre><code>[root@master ~]$ hadoop fs
等同于
[root@master ~]$ hdfs dfs
-ls #查看目录结构
-lsr #递归查看目录结构
-du #查看目录下各文件大小
-dus #汇总查看目录下文件大小
-count #统计文件(夹)数量     文件夹 文件 大小
-mv #移动
-cp #复制
-rm #删除
-rmr #递归删除
-put #上传文件
-get #下载文件
-getmerge #下载多个文件并合并
-appendToFile - #通过终端向文件输入内容
-cat #查看文件内容
-text #查看文件内容
-stat #查看文件属性     %b 文件大小     %o block 大小     %r 副本数     %n 文件名     hdfs dfs -stat %b^%o^%n /123.txt
-mkdir #创建文件夹
-touchz #创建空文件
-setrep #修改副本数量     replication(复制)
-chmod #修改权限
-chown #修改用户组
-expunge #清空回收站
-help [cmd] #帮助

[root@master ~]$ hadoop jar hadoop-mapreduce-examples-2.7.0.jar pi 2 2 #运行 MapReduce

[root@master ~]$ hdfs fsck / #文件系统检查工具
-move #移动受损文件到/lost+found
-delete	#删除受损文件
-files	#显示被检查的文件
-blocks	#显示块信息报告
-locations #显示每个块的位置信息

[root@master ~]$ hdfs balancer #平衡 block

[root@master ~]$ hdfs dfsadmin
-report #查看集群状态
-safemode &lt;enter | leave | get | wait&gt; #进入|离开|获知|等待 安全模式
</code></pre></div><div class=sharing style=text-align:center><br><p>捐赠支持</p><p>如果我的文章对你有所帮助，欢迎通过支付宝的扫一扫，轻松的向我发起捐助。</p><p>对于你的支持，我会心怀感激且倍感荣幸地接受，并继续努力。</p><img src=https://ww4.sinaimg.cn/large/a15b4afegw1fbn096ql6dj20dw0dwwe9.jpg alt title data-action=zoom width=40%><p></p><br>&copy; 2015-2020 XhstormR</div></div></div></div><div id=backtop><a href=# title>TOP</a></div><nav id=TableOfContents><ul><li><a href=#hadoop>Hadoop</a></li><li><a href=#hdfs-架构>HDFS 架构</a></li><li><a href=#mapreduce-架构>MapReduce 架构</a></li><li><a href=#yarn-架构>Yarn 架构</a></li><li><a href=#hadoop-1>Hadoop</a></li><li><a href=#hdfs>HDFS</a></li></ul></nav><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/yaml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/kotlin.min.js></script><script>hljs.initHighlightingOnLoad()</script><script src=https://blog.xhstormr.tk/js/zoom.min.js></script><script>window.addEventListener("load",show),window.onscroll=show;function show(){document.documentElement.scrollTop+document.body.scrollTop>300?document.getElementById("backtop").style.display="block":document.getElementById("backtop").style.display="none"}</script><script type=text/javascript color=0,0,0 opacity=1 zindex=-2 count=49 src=https://cdnjs.cloudflare.com/ajax/libs/canvas-nest.js/2.0.4/canvas-nest.js></script></body></html>