<!doctype html><html lang=zh-cn manifest=https://blog.xhstormr.tk/offline.appcache><head><meta charset=utf-8><meta name=renderer content="webkit"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>JSP Model1 &#183; XhstormR</title><link rel=alternate type=application/rss+xml title=XhstormR href><link rel=icon type=image/x-icon href=https://blog.xhstormr.tk/favicon.ico><link rel=stylesheet href=https://blog.xhstormr.tk/css/uno.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/monokai-sublime.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js></script><script src=https://blog.xhstormr.tk/js/main.min.js async defer></script></head><body><div id=scriptHeader><span class="mobile btn-mobile-menu"><i class="fa fa-bars btn-mobile-menu__icon"></i>
<i class="fa fa-times btn-mobile-close__icon hidden"></i></span><header class="panel-cover panel-cover--collapsed"><div class=panel-main><div class="panel-main__inner panel-inverted"><div class=panel-main__content><h1 class="panel-cover__title panel-title"><a href=https://blog.xhstormr.tk/ title="link to homepage for XhstormR">XhstormR</a></h1><hr class=panel-cover__divider><p class=panel-cover__description>On a dark desert highway, cool wind in my hair.</p><hr class="panel-cover__divider panel-cover__divider--secondary"><div class=navigation-wrapper><nav class="cover-navigation cover-navigation--primary"><ul class=navigation><li class=navigation__item><a href=https://blog.xhstormr.tk#blog title="link to XhstormR blog" class=blog-button>Blog</a></li></ul></nav></div></div></div><div class=panel-cover--overlay></div></div></header></div><div class=bodytop><div class=content-wrapper><div class=content-wrapper__inner><div class=post><h1>JSP Model1</h1><span class=post-date>2017-03-18</span><p>Updated on 2017-03-18</p><blockquote><p>JavaBean 模式</p></blockquote><h2 id=src>src</h2><h3 id=dao>dao</h3><h4 id=itemdao>ItemDAO</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>package</span> dao

<span style=color:#66d9ef>import</span> entity.Item
<span style=color:#66d9ef>import</span> util.DBHelp

<span style=color:#66d9ef>object</span> <span style=color:#a6e22e>ItemDAO</span> {
    <span style=color:#a6e22e>@JvmStatic</span>
    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getAllItems</span>() = mutableListOf&lt;Item&gt;().apply {     <span style=color:#960050;background-color:#1e0010>从数据库中获取所有商品</span>
        DBHelp.connection
                .prepareStatement(<span style=color:#e6db74>&#34;SELECT * FROM item;&#34;</span>)
                .executeQuery()
                .use {
                    <span style=color:#66d9ef>while</span> (<span style=color:#66d9ef>it</span>.next()) {     <span style=color:#960050;background-color:#1e0010>遍历</span> ResultSet <span style=color:#960050;background-color:#1e0010>并实例化</span> Item <span style=color:#960050;background-color:#1e0010>实体</span>
                        <span style=color:#66d9ef>val</span> item = Item(
                                id = <span style=color:#66d9ef>it</span>.getInt(<span style=color:#e6db74>&#34;id&#34;</span>),
                                name = <span style=color:#66d9ef>it</span>.getString(<span style=color:#e6db74>&#34;name&#34;</span>),
                                city = <span style=color:#66d9ef>it</span>.getString(<span style=color:#e6db74>&#34;city&#34;</span>),
                                price = <span style=color:#66d9ef>it</span>.getInt(<span style=color:#e6db74>&#34;price&#34;</span>),
                                number = <span style=color:#66d9ef>it</span>.getInt(<span style=color:#e6db74>&#34;number&#34;</span>),
                                picture = <span style=color:#66d9ef>it</span>.getString(<span style=color:#e6db74>&#34;picture&#34;</span>)
                        )
                        <span style=color:#66d9ef>this</span>.add(item)
                    }
                }
    }

    <span style=color:#a6e22e>@JvmStatic</span>
    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getVisitedItems</span>(s: String) = mutableListOf&lt;Item&gt;().apply {     <span style=color:#960050;background-color:#1e0010>根据</span> Cookie <span style=color:#960050;background-color:#1e0010>从数据库中获取所有历史游览商品</span>
        s
                .split(<span style=color:#e6db74>&#39;|&#39;</span>)     String <span style=color:#960050;background-color:#1e0010>➜</span> List&lt;String&gt;
                .reversed()     <span style=color:#960050;background-color:#1e0010>逆转</span>
                .map(String<span style=color:#f92672>::</span>toInt)     String <span style=color:#960050;background-color:#1e0010>➜</span> Int
                .map { getItemById(<span style=color:#66d9ef>it</span>) }     Int <span style=color:#960050;background-color:#1e0010>➜</span> Item
                .forEach { <span style=color:#66d9ef>this</span>.add(<span style=color:#66d9ef>it</span>) }
    }

    <span style=color:#a6e22e>@JvmStatic</span>
    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getItemById</span>(id: Int) = DBHelp.connection     <span style=color:#960050;background-color:#1e0010>根据</span> ID <span style=color:#960050;background-color:#1e0010>从数据库中获取商品</span>
            .prepareStatement(<span style=color:#e6db74>&#34;SELECT * FROM item WHERE id = ?;&#34;</span>).apply { <span style=color:#66d9ef>this</span>.setInt(<span style=color:#ae81ff>1</span>, id) }
            .executeQuery()
            .use {
                <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>it</span>.next()) {     ID <span style=color:#960050;background-color:#1e0010>存在</span>
                    <span style=color:#66d9ef>val</span> item = Item(
                            id = <span style=color:#66d9ef>it</span>.getInt(<span style=color:#e6db74>&#34;id&#34;</span>),
                            name = <span style=color:#66d9ef>it</span>.getString(<span style=color:#e6db74>&#34;name&#34;</span>),
                            city = <span style=color:#66d9ef>it</span>.getString(<span style=color:#e6db74>&#34;city&#34;</span>),
                            price = <span style=color:#66d9ef>it</span>.getInt(<span style=color:#e6db74>&#34;price&#34;</span>),
                            number = <span style=color:#66d9ef>it</span>.getInt(<span style=color:#e6db74>&#34;number&#34;</span>),
                            picture = <span style=color:#66d9ef>it</span>.getString(<span style=color:#e6db74>&#34;picture&#34;</span>)
                    )
                    item
                } <span style=color:#66d9ef>else</span> {     ID <span style=color:#960050;background-color:#1e0010>不存在</span>
                    <span style=color:#66d9ef>val</span> item = Item(
                            id = <span style=color:#ae81ff>0</span>,
                            name = <span style=color:#e6db74>&#34;null&#34;</span>,
                            city = <span style=color:#e6db74>&#34;null&#34;</span>,
                            price = <span style=color:#ae81ff>0</span>,
                            number = <span style=color:#ae81ff>0</span>,
                            picture = <span style=color:#e6db74>&#34;null&#34;</span>
                    )
                    item
                }
            }
}
</code></pre></div><h3 id=entity>entity</h3><h4 id=item>Item</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>package</span> entity

<span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Item</span>(     <span style=color:#960050;background-color:#1e0010>数据类：商品实体</span>
        <span style=color:#66d9ef>val</span> id: Int,
        <span style=color:#66d9ef>val</span> name: String,
        <span style=color:#66d9ef>val</span> city: String,
        <span style=color:#66d9ef>val</span> price: Int,
        <span style=color:#66d9ef>val</span> number: Int,
        <span style=color:#66d9ef>val</span> picture: String
)
</code></pre></div><h3 id=util>util</h3><h4 id=dbhelp>DBHelp</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>package</span> util

<span style=color:#66d9ef>import</span> java.sql.Connection
<span style=color:#66d9ef>import</span> java.sql.DriverManager

<span style=color:#66d9ef>object</span> <span style=color:#a6e22e>DBHelp</span> {
    <span style=color:#a6e22e>@JvmStatic</span>
    <span style=color:#66d9ef>val</span> connection: Connection <span style=color:#66d9ef>by</span> lazy {     <span style=color:#960050;background-color:#1e0010>获得数据库连接</span>
        Class.forName(<span style=color:#e6db74>&#34;org.postgresql.Driver&#34;</span>)
        DriverManager.getConnection(<span style=color:#e6db74>&#34;jdbc:postgresql://127.0.0.1:5432/postgres&#34;</span>, <span style=color:#e6db74>&#34;123&#34;</span>, <span style=color:#e6db74>&#34;123456&#34;</span>)
    }
}
</code></pre></div><h4 id=cookiehelp>CookieHelp</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>package</span> util

<span style=color:#66d9ef>object</span> <span style=color:#a6e22e>CookieHelp</span> {
    <span style=color:#a6e22e>@JvmStatic</span>
    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>addCookie</span>(cookie: String, id: Int) = cookie     <span style=color:#960050;background-color:#1e0010>添加</span> Cookie <span style=color:#960050;background-color:#1e0010>并去重</span>
            .split(<span style=color:#e6db74>&#39;|&#39;</span>)     <span style=color:#960050;background-color:#1e0010>分解（</span>String <span style=color:#960050;background-color:#1e0010>➜</span> List<span style=color:#960050;background-color:#1e0010>）</span>
            .toMutableList().apply { <span style=color:#66d9ef>this</span>.add(id.toString()) }     <span style=color:#960050;background-color:#1e0010>添加</span>
            .distinct()     <span style=color:#960050;background-color:#1e0010>去重</span>
            .fold(<span style=color:#e6db74>&#34;&#34;</span>) { str, s <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>if</span> (str <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span>) s <span style=color:#66d9ef>else</span> str + <span style=color:#e6db74>&#39;|&#39;</span> + s }     <span style=color:#960050;background-color:#1e0010>合并（</span>List <span style=color:#960050;background-color:#1e0010>➜</span> String<span style=color:#960050;background-color:#1e0010>）</span>

    <span style=color:#a6e22e>@JvmStatic</span>
    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>cutCookie</span>(cookie: String) = <span style=color:#66d9ef>if</span> (cookie.split(<span style=color:#e6db74>&#39;|&#39;</span>).count() &gt; <span style=color:#ae81ff>5</span>) cookie.substring(cookie.indexOf(<span style=color:#e6db74>&#39;|&#39;</span>) + <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>else</span> cookie     <span style=color:#960050;background-color:#1e0010>字符串中只保留最近</span> <span style=color:#ae81ff>5</span> <span style=color:#960050;background-color:#1e0010>个商品</span> ID
}
</code></pre></div><h2 id=web>web</h2><h3 id=indexjsp>index.jsp</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#960050;background-color:#1e0010>&lt;</span>%@ page import=&#34;dao.ItemDAO&#34; %&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%@ page import=&#34;entity.Item&#34; %&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%@ page import=&#34;java.util.List&#34; %&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%@ page contentType=&#34;text/html;charset=UTF-8&#34; language=&#34;java&#34; %&gt;
&lt;<span style=color:#f92672>html</span>&gt;
&lt;<span style=color:#f92672>head</span>&gt;
    &lt;<span style=color:#f92672>title</span>&gt;商品列表&lt;/<span style=color:#f92672>title</span>&gt;
    &lt;<span style=color:#f92672>style</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span>&gt;
        <span style=color:#f92672>div</span> {
            <span style=color:#66d9ef>float</span>: <span style=color:#66d9ef>left</span>;
            <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>10</span><span style=color:#66d9ef>px</span>;
        }

        <span style=color:#f92672>div</span> <span style=color:#f92672>dd</span> {
            <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>0</span>;
            <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>10</span><span style=color:#66d9ef>pt</span>;
        }
    &lt;/<span style=color:#f92672>style</span>&gt;
&lt;/<span style=color:#f92672>head</span>&gt;
&lt;<span style=color:#f92672>body</span>&gt;
&lt;<span style=color:#f92672>h1</span>&gt;商品列表&lt;/<span style=color:#f92672>h1</span>&gt;
&lt;<span style=color:#f92672>hr</span>&gt;
&lt;<span style=color:#f92672>center</span>&gt;
    &lt;<span style=color:#f92672>table</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;700&#34;</span> <span style=color:#a6e22e>cellpadding</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>cellspacing</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span>&gt;
        &lt;<span style=color:#f92672>tr</span>&gt;
            &lt;<span style=color:#f92672>td</span>&gt;
                <span style=color:#960050;background-color:#1e0010>&lt;</span>%
                    final List&lt;<span style=color:#f92672>Item</span>&gt; list = ItemDAO.getAllItems();     从数据库中获取所有商品
                    for (Item item : list) {     开始循环
                %&gt;
                &lt;<span style=color:#f92672>div</span>&gt;
                    &lt;<span style=color:#f92672>dl</span>&gt;
                        &lt;<span style=color:#f92672>dt</span>&gt;
                            &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;details.jsp?id=&lt;%=item.getId()%&gt;&#34;</span>&gt;&lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;images/&lt;%=item.getPicture()%&gt;&#34;</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;120&#34;</span> <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;90&#34;</span> <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span>/&gt;&lt;/<span style=color:#f92672>a</span>&gt;
                        &lt;/<span style=color:#f92672>dt</span>&gt;
                        &lt;<span style=color:#f92672>dd</span>&gt;<span style=color:#960050;background-color:#1e0010>&lt;</span>%=item.getName() %&gt;
                        &lt;/<span style=color:#f92672>dd</span>&gt;
                        &lt;<span style=color:#f92672>dd</span>&gt;产地:<span style=color:#960050;background-color:#1e0010>&lt;</span>%=item.getCity()%&gt;&amp;nbsp;&amp;nbsp;价格:￥ <span style=color:#960050;background-color:#1e0010>&lt;</span>%=item.getPrice()%&gt;
                        &lt;/<span style=color:#f92672>dd</span>&gt;
                    &lt;/<span style=color:#f92672>dl</span>&gt;
                &lt;/<span style=color:#f92672>div</span>&gt;
                <span style=color:#960050;background-color:#1e0010>&lt;</span>%
                    }     结束循环
                %&gt;
            &lt;/<span style=color:#f92672>td</span>&gt;
        &lt;/<span style=color:#f92672>tr</span>&gt;
    &lt;/<span style=color:#f92672>table</span>&gt;
&lt;/<span style=color:#f92672>center</span>&gt;
&lt;/<span style=color:#f92672>body</span>&gt;
&lt;/<span style=color:#f92672>html</span>&gt;
</code></pre></div><h3 id=detailsjsp>details.jsp</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#960050;background-color:#1e0010>&lt;</span>%@ page import=&#34;dao.ItemDAO&#34; %&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%@ page import=&#34;entity.Item&#34; %&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%@ page import=&#34;util.CookieHelp&#34; %&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%@ page import=&#34;java.util.List&#34; %&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%@ page contentType=&#34;text/html;charset=UTF-8&#34; language=&#34;java&#34; %&gt;     指定输出字符集
&lt;<span style=color:#f92672>html</span>&gt;
&lt;<span style=color:#f92672>head</span>&gt;
    &lt;<span style=color:#f92672>title</span>&gt;商品详情&lt;/<span style=color:#f92672>title</span>&gt;
    &lt;<span style=color:#f92672>style</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span>&gt;
        <span style=color:#f92672>div</span> {
            <span style=color:#66d9ef>float</span>: <span style=color:#66d9ef>left</span>;
            <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>5</span><span style=color:#66d9ef>px</span> <span style=color:#ae81ff>30</span><span style=color:#66d9ef>px</span>;
        }

        <span style=color:#f92672>div</span> <span style=color:#f92672>dd</span> {
            <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>0</span>;
            <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>10</span><span style=color:#66d9ef>pt</span>;
        }
    &lt;/<span style=color:#f92672>style</span>&gt;
&lt;/<span style=color:#f92672>head</span>&gt;
&lt;<span style=color:#f92672>body</span>&gt;
&lt;<span style=color:#f92672>h1</span>&gt;商品详情&lt;/<span style=color:#f92672>h1</span>&gt;
&lt;<span style=color:#f92672>hr</span>&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%
    request.setCharacterEncoding(&#34;UTF-8&#34;);     指定输入字符集
%&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%
    final int id = Integer.valueOf(request.getParameter(&#34;id&#34;));     获得当前页面的商品 ID
    final Item item = ItemDAO.getItemById(id);     实例化 Item 实体
%&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>%
    boolean hasCookie = false;
    final Cookie[] cookies = request.getCookies();
    for (Cookie c : cookies) {
        if (c.getName().equals(&#34;visitedItem&#34;)) {     处理商品游览历史 Cookie
            hasCookie = true;
            String s1 = CookieHelp.addCookie(c.getValue(), id);     添加商品 ID 并去重
            String s2 = CookieHelp.cutCookie(s1);     Cookie 只保留最近 5 个商品 ID
            c.setValue(s2);
            response.addCookie(c);     添加 Cookie
            break;
        }
    }
    if (!hasCookie) {
        Cookie c = new Cookie(&#34;visitedItem&#34;, String.valueOf(id));     不存在则新建 visitedItem Cookie
        response.addCookie(c);     添加 Cookie
    }
%&gt;
&lt;<span style=color:#f92672>center</span>&gt;
    &lt;<span style=color:#f92672>table</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;700&#34;</span> <span style=color:#a6e22e>cellpadding</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>cellspacing</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span>&gt;
        &lt;<span style=color:#f92672>tr</span>&gt;
            &lt;<span style=color:#f92672>td</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;70%&#34;</span> <span style=color:#a6e22e>valign</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;top&#34;</span>&gt;
                &lt;<span style=color:#f92672>table</span>&gt;
                    &lt;<span style=color:#f92672>tr</span>&gt;
                        &lt;<span style=color:#f92672>td</span> <span style=color:#a6e22e>rowspan</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;4&#34;</span>&gt;&lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;images/&lt;%=item.getPicture()%&gt;&#34;</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;200&#34;</span> <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;160&#34;</span>/&gt;&lt;/<span style=color:#f92672>td</span>&gt;
                    &lt;/<span style=color:#f92672>tr</span>&gt;
                    &lt;<span style=color:#f92672>tr</span>&gt;
                        &lt;<span style=color:#f92672>td</span>&gt;&lt;<span style=color:#f92672>B</span>&gt;<span style=color:#960050;background-color:#1e0010>&lt;</span>%=item.getName()%&gt;
                        &lt;/<span style=color:#f92672>B</span>&gt;&lt;/<span style=color:#f92672>td</span>&gt;
                    &lt;/<span style=color:#f92672>tr</span>&gt;
                    &lt;<span style=color:#f92672>tr</span>&gt;
                        &lt;<span style=color:#f92672>td</span>&gt;产地：<span style=color:#960050;background-color:#1e0010>&lt;</span>%=item.getCity()%&gt;
                        &lt;/<span style=color:#f92672>td</span>&gt;
                    &lt;/<span style=color:#f92672>tr</span>&gt;
                    &lt;<span style=color:#f92672>tr</span>&gt;
                        &lt;<span style=color:#f92672>td</span>&gt;价格：<span style=color:#960050;background-color:#1e0010>&lt;</span>%=item.getPrice()%&gt;￥&lt;/<span style=color:#f92672>td</span>&gt;
                    &lt;/<span style=color:#f92672>tr</span>&gt;
                &lt;/<span style=color:#f92672>table</span>&gt;
            &lt;/<span style=color:#f92672>td</span>&gt;
            &lt;<span style=color:#f92672>td</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;30%&#34;</span> <span style=color:#a6e22e>bgcolor</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#EEE&#34;</span> <span style=color:#a6e22e>align</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;center&#34;</span>&gt;
                &lt;<span style=color:#f92672>br</span>&gt;
                &lt;<span style=color:#f92672>b</span>&gt;您最近浏览的商品&lt;/<span style=color:#f92672>b</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
                <span style=color:#960050;background-color:#1e0010>&lt;</span>%
                    for (Cookie c : request.getCookies()) {
                        if (c.getName().equals(&#34;visitedItem&#34;)) {
                            List&lt;<span style=color:#f92672>Item</span>&gt; list = ItemDAO.getVisitedItems(c.getValue());     根据 Cookie 从数据库中获取所有历史游览商品
                            for (Item i : list) {     开始循环
                %&gt;
                &lt;<span style=color:#f92672>div</span>&gt;
                    &lt;<span style=color:#f92672>dl</span>&gt;
                        &lt;<span style=color:#f92672>dt</span>&gt;
                            &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;details.jsp?id=&lt;%=i.getId()%&gt;&#34;</span>&gt;&lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;images/&lt;%=i.getPicture()%&gt;&#34;</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;120&#34;</span> <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;90&#34;</span> <span style=color:#a6e22e>border</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span>/&gt;&lt;/<span style=color:#f92672>a</span>&gt;
                        &lt;/<span style=color:#f92672>dt</span>&gt;
                        &lt;<span style=color:#f92672>dd</span>&gt;<span style=color:#960050;background-color:#1e0010>&lt;</span>%=i.getName()%&gt;
                        &lt;/<span style=color:#f92672>dd</span>&gt;
                        &lt;<span style=color:#f92672>dd</span>&gt;产地:<span style=color:#960050;background-color:#1e0010>&lt;</span>%=i.getCity()%&gt;&amp;nbsp;&amp;nbsp;价格:<span style=color:#960050;background-color:#1e0010>&lt;</span>%=i.getPrice()%&gt; ￥&lt;/<span style=color:#f92672>dd</span>&gt;
                    &lt;/<span style=color:#f92672>dl</span>&gt;
                &lt;/<span style=color:#f92672>div</span>&gt;
                <span style=color:#960050;background-color:#1e0010>&lt;</span>%
                            }     结束循环
                            break;
                        }
                    }
                %&gt;
            &lt;/<span style=color:#f92672>td</span>&gt;
        &lt;/<span style=color:#f92672>tr</span>&gt;
    &lt;/<span style=color:#f92672>table</span>&gt;
&lt;/<span style=color:#f92672>center</span>&gt;
&lt;/<span style=color:#f92672>body</span>&gt;
&lt;/<span style=color:#f92672>html</span>&gt;
</code></pre></div><h2 id=sql>sql</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> item (
  id      SERIAL,
  name    TEXT    <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  city    TEXT    <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  price   INTEGER <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  number  INTEGER <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  picture TEXT    <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (id)
);

<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;沃特篮球鞋&#39;</span>, <span style=color:#e6db74>&#39;佛山&#39;</span>, <span style=color:#e6db74>&#39;180&#39;</span>, <span style=color:#e6db74>&#39;500&#39;</span>, <span style=color:#e6db74>&#39;001.jpg&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;安踏运动鞋&#39;</span>, <span style=color:#e6db74>&#39;福州&#39;</span>, <span style=color:#e6db74>&#39;120&#39;</span>, <span style=color:#e6db74>&#39;800&#39;</span>, <span style=color:#e6db74>&#39;002.jpg&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;耐克运动鞋&#39;</span>, <span style=color:#e6db74>&#39;广州&#39;</span>, <span style=color:#e6db74>&#39;500&#39;</span>, <span style=color:#e6db74>&#39;1000&#39;</span>, <span style=color:#e6db74>&#39;003.jpg&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;阿迪达斯T血衫&#39;</span>, <span style=color:#e6db74>&#39;上海&#39;</span>, <span style=color:#e6db74>&#39;388&#39;</span>, <span style=color:#e6db74>&#39;600&#39;</span>, <span style=color:#e6db74>&#39;004.jpg&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;李宁文化衫&#39;</span>, <span style=color:#e6db74>&#39;广州&#39;</span>, <span style=color:#e6db74>&#39;180&#39;</span>, <span style=color:#e6db74>&#39;900&#39;</span>, <span style=color:#e6db74>&#39;005.jpg&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;小米3&#39;</span>, <span style=color:#e6db74>&#39;北京&#39;</span>, <span style=color:#e6db74>&#39;1999&#39;</span>, <span style=color:#e6db74>&#39;3000&#39;</span>, <span style=color:#e6db74>&#39;006.jpg&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;小米2S&#39;</span>, <span style=color:#e6db74>&#39;北京&#39;</span>, <span style=color:#e6db74>&#39;1299&#39;</span>, <span style=color:#e6db74>&#39;1000&#39;</span>, <span style=color:#e6db74>&#39;007.jpg&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;thinkpad笔记本&#39;</span>, <span style=color:#e6db74>&#39;北京&#39;</span>, <span style=color:#e6db74>&#39;6999&#39;</span>, <span style=color:#e6db74>&#39;500&#39;</span>, <span style=color:#e6db74>&#39;008.jpg&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;dell笔记本&#39;</span>, <span style=color:#e6db74>&#39;北京&#39;</span>, <span style=color:#e6db74>&#39;3999&#39;</span>, <span style=color:#e6db74>&#39;500&#39;</span>, <span style=color:#e6db74>&#39;009.jpg&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> item (name, city, price, number, picture) <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;ipad5&#39;</span>, <span style=color:#e6db74>&#39;北京&#39;</span>, <span style=color:#e6db74>&#39;5999&#39;</span>, <span style=color:#e6db74>&#39;500&#39;</span>, <span style=color:#e6db74>&#39;010.jpg&#39;</span>);
</code></pre></div></div><div class=sharing style=text-align:center><br><p>捐赠支持</p><p>如果我的文章对你有所帮助，欢迎通过支付宝的扫一扫，轻松的向我发起捐助。</p><p>对于你的支持，我会心怀感激且倍感荣幸地接受，并继续努力。</p><img src=https://ww4.sinaimg.cn/large/a15b4afegw1fbn096ql6dj20dw0dwwe9.jpg alt title data-action=zoom width=40%><p></p><br>&copy; 2015-2020 XhstormR</div></div></div></div><div id=backtop><a href=# title>TOP</a></div><nav id=TableOfContents><ul><li><a href=#src>src</a><ul><li><a href=#dao>dao</a></li><li><a href=#entity>entity</a></li><li><a href=#util>util</a></li></ul></li><li><a href=#web>web</a><ul><li><a href=#indexjsp>index.jsp</a></li><li><a href=#detailsjsp>details.jsp</a></li></ul></li><li><a href=#sql>sql</a></li></ul></nav><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/yaml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/kotlin.min.js></script><script>hljs.initHighlightingOnLoad()</script><script src=https://blog.xhstormr.tk/js/zoom.min.js></script><script>window.addEventListener("load",show),window.onscroll=show;function show(){document.documentElement.scrollTop+document.body.scrollTop>300?document.getElementById("backtop").style.display="block":document.getElementById("backtop").style.display="none"}</script><script type=text/javascript color=0,0,0 opacity=1 zindex=-2 count=49 src=https://cdnjs.cloudflare.com/ajax/libs/canvas-nest.js/2.0.4/canvas-nest.js></script></body></html>